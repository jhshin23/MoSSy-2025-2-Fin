
<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.2/mqttws31.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" type="text/javascript"></script>
        <script src="/static/myChart.js" type="text/javascript"></script>
        <script src="/static/mqttio.js"></script>
	<script id = "broker"></script>
	<script>
		window.addEventListener("load", drawChart);
		window.addEventListener("load", ()=>{
                    // 현재 페이지 주소에서 IP 자동 추출
                    let url = String(document.location);
                    let ip = (url.split("//"))[1]; // "192...:8080/..."
                    ip = (ip.split(":"))[0];
                    document.getElementById("broker").textcontent = ip;
                });
                
	</script>
        <title id="tabTitle">책상 대시보드</title>
    </head>
    <body onload = "connect()">
<h3>상태: <span id="masterAuthSpan">미인증</span><br>
	<span id="useState">사용안함</span></h3>
        <button id="AuthForStart" type="button" onclick="publish('authReq', 'setDistanceAuth')">인증해서 착석 시작하기</button>
        <button id="AuthForLeave" type="button" onclick="publish('authReq', 'notUse')">인증해서 떠나기</button>
        <div id="sittingState"></div>
<br>
        <h3>초음파</h3>
        <button id="hideshow0" onclick="hideshow('ultraCanvas')">Hide/Show Chart</button>
        <canvas id="ultraCanvas" width="600" height="400"></canvas>
<br>
        <div id="sittingState"></div>
        <hr>
        <h3>책제목 입력하기</h3>
        <form id="bookTitleForm" autocomplete="off">
            <textarea name="" id="bookTitle"></textarea><br>
            <button id="AuthForManagerBtn" type="button" onclick="publish('authReq', 'inputAuth:'+document.getElementById('bookTitle').value)">인증해서 입력하기</button>
        </form>
        <h3>독서 활동</h3>
	<h3 id="titleHead"></h3>
        <form id="subscribe-form-shadow">
            <input type="button" onclick="subscribe('shadowOnBook')" value="측정시작">
            <input type="button" onclick="unsubscribe('shadowOnBook')" value="측정중단">
        </form>
        <hr>
        <h3>조도의 변화 관찰</h3>
	<h3 id="shadowCount"></h3>
        <form id="subscribe-form-light">
            <input type="button" onclick="subscribe('light')" value="측정시작">
            <input type="button" onclick="unsubscribe('light')" value="측정중단">
        </form>
        <button id="hideshow1" onclick="hideshow('lightCanvas')">Hide/Show Chart</button>
        <canvas id="lightCanvas" width="600" height="400"></canvas>
        <hr>
        <h3>숨쉬기 인증</h3>
        <button id="AuthForViewerBtn" type="button" onclick="publish('authReq', 'checkAuth')">인증요청</button>
	<div>결과:<span id="viewerAuthSpan"></span> </div>
        <hr>
        

    </body>
</html>

